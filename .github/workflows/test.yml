name: 'Test Run'
run-name: 'Deleting all record in curriculum architect table for ${{ inputs.environment }}::${{ inputs.aws_region }}'

on:
  workflow_dispatch:
    inputs:
      environment:
        type: choice
        required: true
        description: Environment
        options:
          - development
          - staging
          - production # woah! don't do this!

permissions:
  id-token: write
  contents: read

jobs:
   google-chat-action:
    name: Google Chat GitHub Action
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        id: checkout
        uses: actions/checkout@v4

      - name: Test Echo
        id: echo
        run: echo "Hello, this is a test run for environment ${{ inputs.environment }} in region ${{ inputs.aws_region }}"

      - name: Notify Google Chat
        if: ${{ always() }} # Use always to ensure that the notification is also send on failure of former steps
        uses: SimonScholz/google-chat-action@main
        with:
          webhookUrl: '${{secrets.GOOGLE_CHAT_WEBHOOK_URL}}'
          jobStatus: ${{ job.status }}
          title: Production Deployment Notification ðŸ””
          subtitle: 'Deployment to ${{ inputs.environment }} was ${{ job.status }}'
          imageUrl: ${{ job.status == 'success' && 'https://media1.tenor.com/m/ZQdH9YACdxQAAAAC/ip-meme.gif' || 'https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.istockphoto.com%2Fphotos%2Ftroll-meme&psig=AOvVaw3EtKrcdEOnTVoBVykxbTYg&ust=1749289836494000&source=images&cd=vfe&opi=89978449&ved=0CBAQjRxqFwoTCOiqw8zC3I0DFQAAAAAdAAAAABAEs' }}
          
