name: 'Test Run'
run-name: 'Deleting all record in curriculum architect table for ${{ inputs.environment }}::${{ inputs.aws_region }}'

on:
  workflow_dispatch:
    inputs:
      environment:
        type: choice
        required: true
        description: Environment
        options:
          - development
          - staging
          - production # woah! don't do this!

permissions:
  id-token: write
  contents: read

jobs:
   google-chat-action:
    name: Google Chat GitHub Action
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        id: checkout
        uses: actions/checkout@v4

      - name: Test Echo
        id: echo
        run: |
            echo "Hello, this is a test run for environment ${{ inputs.environment }} in region ${{ inputs.aws_region }}"
            exit 1

      - name: Notify Google Chat
        if: ${{ always() }} # Use always to ensure that the notification is also send on failure of former steps
        uses: SimonScholz/google-chat-action@main
        with:
          webhookUrl: '${{secrets.GOOGLE_CHAT_WEBHOOK_URL}}'
          jobStatus: ${{ job.status }}
          imageType: 'SQUARE'
          title: Production Deployment Notification ðŸ””
          subtitle: 'Deployment to ${{ inputs.environment }} was ${{ job.status }}'
          imageUrl: ${{ job.status == 'success' && 'https://media1.tenor.com/m/ZQdH9YACdxQAAAAC/ip-meme.gif' || 'https://i0.wp.com/s2.quickmeme.com/img/14/148dd98d2dd039094309d0606717ab7f51337c2a2689278c02b1bbab4a3ec0e5.jpg' }}
          
